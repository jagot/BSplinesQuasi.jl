<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Ordinary differential equations · BSplinesQuasi</title><link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/4.2.0/normalize.min.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.2.0/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link href="../assets/documenter.css" rel="stylesheet" type="text/css"/><script src="../assets/latex.js"></script></head><body><nav class="toc"><a href="../"><img class="logo" src="../assets/logo.svg" alt="BSplinesQuasi logo"/></a><h1>BSplinesQuasi</h1><select id="version-selector" onChange="window.location.href=this.value" style="visibility: hidden"></select><form class="search" id="search-form" action="../search/"><input id="search-query" name="q" type="text" placeholder="Search docs"/></form><ul><li><a class="toctext" href="../">Home</a></li><li><a class="toctext" href="../theory/">Theory</a></li><li><span class="toctext">Usage</span><ul><li><a class="toctext" href="../usage/">Basis creation</a></li><li><a class="toctext" href="../knot_sets/">Knot sets</a></li><li><span class="toctext">Splines</span><ul><li><a class="toctext" href="../splines/">Spline creation &amp; evaluation</a></li><li><a class="toctext" href="../function_approximation/">Function approximation</a></li></ul></li><li><span class="toctext">Examples</span><ul><li><a class="toctext" href="../differentiation/">Differentiating functions</a></li><li class="current"><a class="toctext" href>Ordinary differential equations</a><ul class="internal"><li><a class="toctext" href="#Hooke&#39;s-law-1">Hooke&#39;s law</a></li></ul></li></ul></li></ul></li></ul></nav><article id="docs"><header><nav><ul><li>Usage</li><li>Examples</li><li><a href>Ordinary differential equations</a></li></ul><a class="edit-page" href="https://github.com/jagot/BSplinesQuasi.jl/blob/master/docs/src/odes.md"><span class="fa"></span> Edit on GitHub</a></nav><hr/><div id="topbar"><span>Ordinary differential equations</span><a class="fa fa-bars" href="#"></a></div></header><h1><a class="nav-anchor" id="Ordinary-differential-equations-1" href="#Ordinary-differential-equations-1">Ordinary differential equations</a></h1><p>It is easy to solve ordinary differential equations using B-splines, as long as they are linear. For non-linear ODEs, the simplest way is most likely to linearize the equations, solve the resulting equation system (as illustrated below), and combining this with fixed-point iteration or Newton&#39;s method.</p><h2><a class="nav-anchor" id="Hooke&#39;s-law-1" href="#Hooke&#39;s-law-1">Hooke&#39;s law</a></h2><p>A spring that is extended from its equilibrium point by <span>$x$</span> experiences a restoring force</p><div>\[\begin{equation}
F = -kx,
\end{equation}\]</div><p>where <span>$k$</span> is the <em>spring constant</em>. The potential energy of the spring is related to the force as</p><div>\[\begin{equation}
F = -\nabla V(x).
\end{equation}\]</div><p>We can find this potential by solving a boundary value problem, expanding <span>$F$</span> in B-splines. Since we do not know the values of <span>$V(x)$</span> at the edges of the domain, we can employ the fact that the restoring force is antisymmetric and that <span>$V(0)=0$</span>, and solve the problem on the half-domain <span>$[0,x_{\textrm{max}}]$</span>. This turns the problem into an initial-value problem.</p><p>We proceed as indicted in <a href="../theory/#Solving-equations-1">Solving equations</a>:</p><pre><code class="language-julia">julia&gt; function ode_hookes_law(xₘₐₓ, kspring, k, N)
           t = LinearKnotSet(k, 0, xₘₐₓ, N)
           # By omitting the first basis function, we enforce V(0) = 0
           B = BSpline(t,0)[:,2:end]
           S = B&#39;B

           D = Derivative(axes(B, 1))
           ∇ = B&#39;D*B

           # Hooke&#39;s law
           F = x -&gt; -kspring*x

           # Expand Hooke&#39;s law on B-splines
           cF = B \ F
           # Solve for expansion coefficients of potential
           cV = -∇ \ S*cF

           cF,cV
       end

julia&gt; cF,cV = ode_hookes_law(3, 0.1, 7, 30)
([-0.00166667, -0.005, -0.01, -0.0166667, -0.025, -0.035, -0.045, -0.055, -0.065, -0.075  …  -0.235, -0.245, -0.255, -0.265, -0.275, -0.283333, -0.29, -0.295, -0.298333, -0.3], [1.02078e-16, 6.66667e-5, 0.000366667, 0.00116667, 0.00283333, 0.00583333, 0.00983333, 0.0148333, 0.0208333, 0.0278333  …  0.275833, 0.299833, 0.324833, 0.350833, 0.377833, 0.401167, 0.420367, 0.435067, 0.445, 0.45])</code></pre><p>We can compare the approximation with the exact potential, given by</p><div>\[\begin{equation}
V(x) = \frac{kx^2}{2}.
\end{equation}\]</div><p><img src="../figures/hookes-law-7-30.svg" alt="Hooke&#39;s law and harmonic potential"/></p><p><em>However</em>, since the restoring force is linear, the potential can at most be quadratic; furthermore, we only need one interval to solve the problem exactly:</p><pre><code class="language-julia">julia&gt; cF,cV = ode_hookes_law(3, 0.1, 3, 1)
([-0.15, -0.3], [-2.77556e-17, 0.45])</code></pre><p><img src="../figures/hookes-law-3-1.svg" alt="Hooke&#39;s law and harmonic potential"/></p><div class="admonition note"><div class="admonition-title">Note</div><div class="admonition-text"><p>Other boundary conditions, such as <span>$y(a)=\alpha$</span>, or <span>$y&#39;(a)=\beta$</span>, do not yet have a simple implementation. This mean that it is not convenient (but not impossible) to solve boundary-value problems with other boundary conditions than <span>$y(a)=y(b)=0$</span>, or initial-value problems with other initial values than <span>$y(a)=0$</span>.</p></div></div><footer><hr/><a class="previous" href="../differentiation/"><span class="direction">Previous</span><span class="title">Differentiating functions</span></a></footer></article></body></html>
